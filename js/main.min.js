$(document).ready(function(){var a=function(){return[new ol.style.Style({fill:new ol.style.Fill({color:"rgba(225, 130, 41, 0.6)"}),stroke:new ol.style.Stroke({color:"rgba(225, 92, 41, 0.8)",width:1})})]},b={},c=function(a,c){var d=a.get("features").length,e=1==d&&c<60?a.get("features")[0].get("name"):d.toString();b[d];return[new ol.style.Style({image:new ol.style.Circle({radius:10,fill:new ol.style.Fill({color:"rgb(225, 130, 41)"}),stroke:new ol.style.Stroke({color:"rgb(225, 92, 41)",width:1})}),text:new ol.style.Text({scale:1.2,text:e,fill:new ol.style.Fill({color:"#fff"}),stroke:new ol.style.Stroke({color:"#000"})})})]},e=function(a,b){var c=a.get("features").length,d=1==c&&b<60?a.get("features")[0].get("name"):c.toString();e[c];return[new ol.style.Style({image:new ol.style.Circle({radius:10,fill:new ol.style.Fill({color:"rgb(180, 10, 10)"}),stroke:new ol.style.Stroke({color:"rgb(180, 10, 10)",width:1})}),text:new ol.style.Text({scale:1.2,text:d,fill:new ol.style.Fill({color:"#fff"}),stroke:new ol.style.Stroke({color:"#000"})})})]},f=function(a,b){var c=a.get("features").length,d=1==c&&b<60?a.get("features")[0].get("name"):c.toString();f[c];return[new ol.style.Style({image:new ol.style.Circle({radius:10,fill:new ol.style.Fill({color:"rgb(180, 190, 40)"}),stroke:new ol.style.Stroke({color:"rgb(180, 160, 20)",width:1})}),text:new ol.style.Text({scale:1.2,text:d,fill:new ol.style.Fill({color:"#fff"}),stroke:new ol.style.Stroke({color:"#000"})})})]},g=function(a){return[new ol.style.Style({stroke:new ol.style.Stroke({color:"rgba(160,140,0,1)",width:3})})]},h=function(a){return[new ol.style.Style({image:new ol.style.Circle({radius:5,stroke:new ol.style.Stroke({color:"rgba(0,127,255,0.8)",width:1})}),stroke:new ol.style.Stroke({color:"rgba(0,127,255,0.8)",width:1})})]},i=function(a,b){var c=b<20?a.get("name"):"";return[new ol.style.Style({stroke:new ol.style.Stroke({color:"#A62A2A",width:2.5}),text:new ol.style.Text({scale:1.5,text:c,fill:new ol.style.Fill({color:"#fff"}),stroke:new ol.style.Stroke({color:"#000",width:1.7})})})]},j=function(a){return[new ol.style.Style({image:new ol.style.Icon({anchor:[.6,.4],anchorOrigin:"bottom-right",anchorXUnits:"pixels",anchorYUnits:"pixels",offsetOrigin:"bottom-right",src:"img/viv_ico3.png"})})]},k=function(){return[new ol.style.Style({fill:new ol.style.Fill({color:"rgba(0, 238, 118, 0.3)"}),stroke:new ol.style.Stroke({color:"rgb(0, 238, 118)",width:1})})]};ol.proj.get("EPSG:3857");view=new ol.View({center:[-6942316.656972848,-1050856.264864603],zoom:9,maxZoom:18,minZoom:2});var m=new ol.layer.Tile({source:new ol.source.XYZ({url:"https://{a-c}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png"}),visible:!1,name:"mapquest"}),n=new ol.layer.Tile({source:new ol.source.BingMaps({key:"Aqh3opxIgZXX9tgD-qzCGUijcoJU_6cZfUrKzB6sWLUhddRjsXTIuRwzz7E7DDYe",imagerySet:"AerialWithLabels"}),visible:!0,name:"bingmaps"}),o=new ol.layer.Vector({source:new ol.source.Vector({url:"data/kml/radAreaMerged.kml",format:new ol.format.KML({extractStyles:!1})}),style:a,name:"lotesLayer",visible:!1}),p=new ol.source.Vector({url:"data/kml/rad_merge.kml",format:new ol.format.KML({extractStyles:!1,extractAttributes:!0})}),q=new ol.layer.Vector({source:new ol.source.Vector({url:"data/kml/municipiosRioterra.kml",format:new ol.format.KML({extractStyles:!1})}),style:g,name:"limlayer",visible:!0}),r=new ol.layer.Vector({source:new ol.source.Vector({url:"data/kml/drenagem.kml",format:new ol.format.KML({extractStyles:!1})}),style:h,name:"drenagemLayer",visible:!1}),s=new ol.layer.Vector({source:new ol.source.Vector({url:"data/kml/ucs.kml",format:new ol.format.KML({extractStyles:!1})}),style:k,name:"UCLayer",visible:!1}),t=new ol.source.Vector({url:"data/kml/ater.kml",format:new ol.format.KML({extractStyles:!1})}),u=new ol.source.Vector({url:"data/kml/carsMerged.kml",format:new ol.format.KML({extractStyles:!1})}),w=(new ol.source.Vector({url:"data/kml/cars.kml",format:new ol.format.KML({extractStyles:!1})}),new ol.layer.Vector({source:new ol.source.Vector({url:"data/kml/rodovias.kml",format:new ol.format.KML({extractStyles:!1})}),style:i,name:"estradasLayer",visible:!1})),x=new ol.layer.Vector({source:new ol.source.Vector({url:"data/kml/viveiro_itapua.kml",format:new ol.format.KML({extractStyles:!1})}),style:j,name:"viveiroLayer",visible:!1}),y=new ol.source.Cluster({distance:40,source:p}),z=new ol.layer.Vector({source:y,style:c,name:"clusters",visible:!1}),A=new ol.source.Cluster({distance:40,source:u}),B=new ol.layer.Vector({source:A,style:e,name:"carLayer",visible:!1}),C=new ol.source.Cluster({distance:40,source:t}),D=new ol.layer.Vector({source:C,style:f,name:"aterLayer",visible:!1}),E=new ol.source.Vector,F=new ol.layer.Vector({source:E,name:"vectorMeasure",style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"#ffcc33",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ffcc33"})})})});map=new ol.Map({target:"mapa",controls:ol.control.defaults().extend([new ol.control.ScaleLine({className:"ol-scale-line",target:document.getElementById("scale-line")}),new ol.control.Zoom({zoomInTipLabel:"Mais zoom",zoomOutTipLabel:"Menos zoom"}),new ol.control.Attribution({tipLabel:"Atribuições"}),new ol.control.FullScreen({tipLabel:"Modo Tela-cheia Entrar/Sair"})]),renderer:"canvas",layers:[m,n,F,q,s,r,w,o,z,x,B,D],view:view}),$("#esconder").addClass("selected"),$("#esconder").on("click",function(a){$(this).hasClass("selected")?($(this).removeClass("selected"),$(this).children("i").removeClass("fa-angle-left"),$(this).children("i").addClass("fa-angle-right"),$("#camadas").slideToggle()):($(this).addClass("selected"),$(this).children("i").addClass("fa-angle-left"),$(this).children("i").removeClass("fa-angle-right"),$("#camadas").slideToggle())}),$("#lim").addClass("selected"),$("ul.classecamadas li").on("click",function(a){a.stopPropagation();var b=$("input",this);b.attr("checked")?(b.attr("checked",!1),$(this).removeClass("selected")):(b.attr("checked",!0),$(this).addClass("selected"));var c={arearad:[z,o],areacar:B,areaater:D,drenagem:r,limsemeando:q,estradas:w,viveiro:x,ucs:s}[$(this).children("input").attr("id")];Array.isArray(c)?c.forEach(function(a){a.setVisible(!a.getVisible())}):c.setVisible(!c.getVisible())}),$("input[type=radio]").on("change",function(){var a=$(this).val();map.getLayers().getArray().forEach(function(b){var c=b.get("name");"lotesLayer"!=c&&"drenagemLayer"!=c&&"zseeLayer"!=c&&"aterlayer"!=c&&"limlayer"!=c&&"sedeRadLayer"!=c&&"carLayer"!=c&&"estradasLayer"!=c&&"clusters"!=c&&"viveiroLayer"!=c&&"UCLayer"!=c&&"vectorMeasure"!=c&&"geomorfologiaLayer"!=c&&"geologiaLayer"!=c&&b.setVisible(c==a)})});var G=new ol.Geolocation({projection:view.getProjection(),tracking:!0});$("#geolocation").click(function(){var a=G.getPosition(),b=new ol.layer.Vector({source:new ol.source.Vector({features:[new ol.Feature({geometry:new ol.geom.Point(a)})]})});return map.addLayer(b),view.setCenter(a),view.setResolution(2.388),!1});var H=$("#info");H.tooltip({animation:!1,trigger:"manual"});var I=function(a){H.css({left:a[0]+"px",top:a[1]-1+"px"});var b=map.forEachFeatureAtPixel(a,function(a){return a});b.get("name")||void 0!=b.get("features")&&1==b.get("features").length?H.tooltip("hide").attr("data-original-title",b.get("features")?b.get("features")[0].get("name"):b.get("name")).tooltip("fixTitle").tooltip("show"):H.tooltip("hide")};map.on("pointermove",function(a){return a.dragging||!map.hasFeatureAtPixel(a.pixel)?void H.tooltip("hide"):void I(map.getEventPixel(a.originalEvent))});var J=new ol.style.Style({image:new ol.style.Circle({radius:5,fill:new ol.style.Fill({color:"rgba(255, 255, 0, 0.4)"}),stroke:new ol.style.Stroke({color:"rgba(255, 225, 0, 0.6)",width:2})}),fill:new ol.style.Fill({color:"rgba(255, 255, 0, 0.4)"}),stroke:new ol.style.Stroke({color:"rgba(255, 255, 0, 0.6)",width:2})}),K=new ol.interaction.Select({layers:function(a){return 1==a.get("selectable")},style:[J]});map.getInteractions().extend([K]),o.set("selectable",!0),A.set("selectable",!0);var L=document.getElementById("popup"),M=document.getElementById("popup-content"),N=document.getElementById("popup-coord"),O=document.getElementById("popup-closer"),P=new ol.Overlay({element:L,autoPan:!0,autoPanAnimation:{duration:250}});map.addOverlay(P),O.onclick=function(){return P.setPosition(void 0),O.blur(),!1},map.on("singleclick",function(a){var b=map.forEachFeatureAtPixel(a.pixel,function(a,b){return a});if(b&&b.get("description")){var c=a.coordinate,d=ol.coordinate.toStringHDMS(ol.proj.transform(c,"EPSG:3857","EPSG:4326"));if(M.innerHTML="<p>"+b.getProperties().description+"</p>",N.innerHTML="<p><strong>"+d+"</strong></p>",P.setPosition(c),"Viveiro Municipal de Itapuã do Oeste"==b.get("name")){var e=function(a){for(var b=function(a){for(var e,f,g,h,b=a.childNodes,c=b.length,d=[],i=0;i<c;i++)e=b[i],1===e.nodeType&&(f=e.children[0],g=f.getAttribute("data-size").split("x"),h={src:f.getAttribute("href"),w:parseInt(g[0],10),h:parseInt(g[1],10)},e.children.length>1&&(h.title=e.children[1].innerHTML),f.children.length>0&&(h.msrc=f.children[0].getAttribute("src")),h.el=e,d.push(h));return d},c=function a(b,c){return b&&(c(b)?b:a(b.parentNode,c))},d=function(a){a=a||window.event,a.preventDefault?a.preventDefault():a.returnValue=!1;var b=a.target||a.srcElement,d=c(b,function(a){return a.tagName&&"FIGURE"===a.tagName.toUpperCase()});if(d){for(var j,e=d.parentNode,g=d.parentNode.childNodes,h=g.length,i=0,k=0;k<h;k++)if(1===g[k].nodeType){if(g[k]===d){j=i;break}i++}return j>=0&&f(j,e),!1}},e=function(){var a=window.location.hash.substring(1),b={};if(a.length<5)return b;for(var c=a.split("&"),d=0;d<c.length;d++)if(c[d]){var e=c[d].split("=");e.length<2||(b[e[0]]=e[1])}return b.gid&&(b.gid=parseInt(b.gid,10)),b},f=function(a,c,d,e){var g,h,i,f=document.querySelectorAll(".pswp")[0];if(i=b(c),h={galleryUID:c.getAttribute("data-pswp-uid"),getThumbBoundsFn:function(a){var b=i[a].el.getElementsByTagName("img")[0],c=window.pageYOffset||document.documentElement.scrollTop,d=b.getBoundingClientRect();return{x:d.left,y:d.top+c,w:d.width}}},e)if(h.galleryPIDs){for(var j=0;j<i.length;j++)if(i[j].pid==a){h.index=j;break}}else h.index=parseInt(a,10)-1;else h.index=parseInt(a,10);isNaN(h.index)||(d&&(h.showAnimationDuration=0),g=new PhotoSwipe(f,PhotoSwipeUI_Default,i,h),g.init())},g=document.querySelectorAll(a),h=0,i=g.length;h<i;h++)g[h].setAttribute("data-pswp-uid",h+1),g[h].onclick=d;var j=e();j.pid&&j.gid&&f(j.pid,g[j.gid-1],!0,!0)};e(".my-gallery")}}else if(b&&(b.get("description")||b.get("features"))){if(b&&1==b.get("features").length){var c=a.coordinate,d=ol.coordinate.toStringHDMS(ol.proj.transform(c,"EPSG:3857","EPSG:4326"));M.innerHTML="<p>"+b.get("features")[0].get("description")+"</p>",N.innerHTML="<p><strong>"+d+"</strong></p>",P.setPosition(c)}}else P.setPosition()}),window.measure=function(a,b){function p(){var c="area"==b?"Polygon":"LineString";m=new ol.interaction.Draw({source:E,type:c,style:new ol.style.Style({fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"}),stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new ol.style.Circle({radius:5,stroke:new ol.style.Stroke({color:"rgba(0, 0, 0, 0.7)"}),fill:new ol.style.Fill({color:"rgba(255, 255, 255, 0.2)"})})})}),a.addInteraction(m),r(),q();var i;m.on("drawstart",function(a){d=a.feature;var b=a.coordinate;i=d.getGeometry().on("change",function(a){var d,c=a.target;c instanceof ol.geom.Polygon?(d=o(c),b=c.getInteriorPoint().getCoordinates()):c instanceof ol.geom.LineString&&(d=n(c),b=c.getLastCoordinate()),g.innerHTML=d,h.setPosition(b)})},this),m.on("drawend",function(){g.className="tooltip2 tooltip2-static",h.setOffset([0,-7]),d=null,setTimeout(function(){m.setActive(!1)},100),g=null,e=null,f.setPosition()},this)}function q(){e&&e.parentNode.removeChild(e),e=document.createElement("div"),e.className="tooltip2 hidden",f=new ol.Overlay({element:e,offset:[15,0],positioning:"center-left"}),a.addOverlay(f)}function r(){g&&g.parentNode.removeChild(g),g=document.createElement("div"),g.className="tooltip2 tooltip2-measure",h=new ol.Overlay({element:g,offset:[0,-15],positioning:"bottom-center"}),a.addOverlay(h)}var d,e,f,g,h,c=new ol.Sphere(6378137),i="Clique uma vez para continuar desenhando",j="Clique uma vez para continuar desenhando",k=function(a){if(!a.dragging){var b="Clique para começar a desenhar";if(d){var c=d.getGeometry();c instanceof ol.geom.Polygon?b=i:c instanceof ol.geom.LineString&&(b=j)}null!=e&&(e.innerHTML=b,f.setPosition(a.coordinate),e.classList.remove("hidden"))}};a.on("pointermove",k),a.getViewport().addEventListener("mouseout",function(){null!=e&&e.classList.add("hidden")});var m,l=!0,n=function(b){var d;if(1==l){var e=b.getCoordinates();d=0;for(var f=a.getView().getProjection(),g=0,h=e.length-1;g<h;++g){var i=ol.proj.transform(e[g],f,"EPSG:4326"),j=ol.proj.transform(e[g+1],f,"EPSG:4326");d+=c.haversineDistance(i,j)}}else d=Math.round(100*b.getLength())/100;var k;return k=d>100?Math.round(d/1e3*100)/100+" km":Math.round(100*d)/100+" m"},o=function(b){var d;if(l){var e=a.getView().getProjection(),f=b.clone().transform(e,"EPSG:4326"),g=f.getLinearRing(0).getCoordinates();d=Math.abs(c.geodesicArea(g))}else d=b.getArea();var h;return d>1e3&&(h=Math.round(d/1e3*100)/100+" km<sup>2</sup>"),h=d>1e4?Math.round(d/1e4*100)/100+" ha":Math.round(100*d)/100+" m<sup>2</sup>"};p()}});